@import "normalize.css/normalize"
@import "@fortawesome/fontawesome-free/css/all"
@import url("https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Source+Code+Pro:ital,wght@0,400;0,900;1,400;1,900&family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400&display=swap")
@import _admin
@import _tokens
@import _filters
@import _fixed-at-bottom
@import _loading
@import _popovers

html
  width: 100%
  height: 100%
  scroll-behavior: smooth

body
  width: 100%
  height: 100%
  background-color: $main-background
  color: $main-text-color
  font-family: $body-font, monospace
  line-height: 1.2

main.use-sans-serif
  font-family: $sans-serif-body-font, sans-serif
  font-size: 18px

*
  box-sizing: border-box

*[title]
  cursor: pointer

button
  // Resets
  -webkit-appearance: none
  -moz-appearance: none
  background: transparent
  border: none
  text-align: left
  padding: 0
  cursor: pointer

h1, h1 a
  font-family: $display-font, serif
  margin-top: 0
  color: $title-color
  text-decoration: none

  &:hover,
  &:focus
    text-decoration: none

a
  text-decoration: none
  color: $main-link-color

  &:hover,
  &:focus
    text-decoration: underline

header.page-header,
footer.page-footer
  display: flex
  background-color: $header-footer-background
  justify-content: center
  align-items: center
  min-height: 80px
  padding: 20px 20px
  width: 100%

  h1
    margin: 0

  .constrain-width
    max-width: 1440px

  p
    color: #eee

header.page-header .header-content,
footer.page-footer
  h1 a, h1 a:hover
    border-bottom: none

  a
    border-bottom: 1px dashed lighten($header-footer-background, 20%)
    color: $header-footer-link-color

    &:hover
      border-bottom-style: solid
      text-decoration: none

  i.fa-rss
    padding-left: 10px

header.page-header.timeline-page
  padding-bottom: 0

  .constrain-width
    height: 100%
    display: flex
    flex-wrap: nowrap
    justify-content: space-between

  a.logo-image-link, img.logo
    max-height: 300px
    display: block
    border: 0

  img.logo
    margin-left: -65px
    object-fit: contain

  .header-content
    padding: 0 30px
    align-self: center

  ul
    padding: 0px

    li
      list-style: none

footer.page-footer
  padding: 10px 10px

  .constrain-width p
    text-align: center

div.content-wrapper
  display: flex
  min-height: calc(100vh - 215px)

  &.timeline-page
    display: block
    min-height: calc(100vh - 340px)

.timeline, .single-timeline-wrapper
  position: relative
  width: 90%
  max-width: 1600px
  margin: 0px auto
  padding: 20px 0 100px 0

.timeline.small-top-margin
  padding-top: 5px

.timeline::before
  content: ''
  position: absolute
  top: 0
  left: calc(50% - 2px) // 50% - 1/2 width
  height: 100%
  width: 4px
  background: $timeline-line-color

.timeline-entry
  position: relative
  margin-top: -150px
  pointer-events: none

  &.first
    margin-top: 0px

  &.short
    margin-top: -50px

  &.odd
    .timeline-description
      margin-left: 55%

.timeline-icon
  position: absolute
  left: 50%
  width: 40px
  height: 40px
  margin-left: -20px
  border: 4px solid $timeline-line-color
  border-radius: 50%
  box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.4)
  text-align: center
  vertical-align: middle
  z-index: 1

  i
    color: $timeline-icon-color
    font-size: 20px

  .icon-wrapper
    display: flex
    width: 100%
    height: 100%
    align-items: center
    justify-content: center

  img
    max-width: 20px
    max-height: 20px
    object-fit: contain

.timeline-description
  position: relative
  box-sizing: border-box
  width: 45%
  background-color: $card-background
  padding-top: 20px
  box-shadow: 0px 2px 3px rgba(0, 0, 0, 0.1)
  display: inline-block
  pointer-events: auto
  border: 1px solid $timeline-line-color

  &::after
    background-color: $card-background
    border-color: $timeline-line-color

  a
    text-decoration: underline

    &.define-target
      text-decoration: none

  .entry-wrapper
    margin-left: 20px
    margin-right: 20px

  .entry-footer
    clear: both
    margin-top: 15px
    border-top: 1px solid $timeline-line-color
    background-color: $card-footer-background

  .collection-row, .tags
    display: flex
    padding-top: 5px
    font-style: italic
    font-size: 70%

    button
      font-style: italic
      color: $main-link-color

  .collection-row
    display: flex
    justify-content: space-between
    padding: 5px
    border-bottom: 1px solid transparentize($timeline-line-color, 0.5)

    a > i.fa-twitter
      color: $main-text-color

  .tags
    padding: 5px

    .fa-hashtag
      color: $timestamp-color
      font-size: 80%
      margin-right: 5px

    .tag-list
      white-space: nowrap
      text-overflow: ellipsis
      overflow: hidden

      &.theme
        flex-shrink: 0

      &:not(:first-child):before
        color: $timeline-line-color
        content: "|"
        padding: 0 5px

    .tag-group-right
      display: flex
      flex-wrap: wrap
      justify-content: flex-end
      flex-grow: 1
      min-width: 0
      padding-left: 20px

  h2, h2 > button
    font-weight: 900
    line-height: 110%
    margin: 5px 0
    -webkit-margin-before: 5px
    -webkit-margin-after: 5px

    a
      text-decoration: none
      color: $main-text-color

      &:hover
        text-decoration: none

  p, ul
    margin: 5px 0 10px 0
    -webkit-margin-before: 5px
    -webkit-margin-after: 10px

img
  &.clickable
    cursor: pointer

  &.on-dark
    // For images that show poorly on light mode -- adds dark bg
    padding: 5px
    background-color: $dark-card-background

  &.on-light
    // For images that show poorly on dark mode -- adds light bg
    padding: 5px
    background-color: $card-background

.timestamp-and-link-icons
  display: flex
  justify-content: space-between
  align-items: center
  font-size: 80%
  color: $timestamp-color

  i
    color: $timestamp-color

  ul
    display: flex
    padding: 0
    margin: 0

    li
      list-style: none

      &:not(:first-child)
        padding-left: 5px

  .timestamp
    font-style: italic

.permalink-popup
  display: inline
  margin-right: 5px
  font-family: $body-font
  color: $timestamp-color
  background-color: transparentize($card-background, 0.3)

.captioned-image
  clear: both

  .caption
    display: block
    line-height: 120%
    font-style: italic
    font-size: 90%
    margin-top: 10px

  .attribution-link
    font-size: 70%

  img
    width: 100%
    display: block

  &.landscape
    max-width: 200px

  &.is-logo
    width: clamp(100px, 25%, 150px)
    text-align: center

.sub-entry
  clear: both
  margin-top: 30px

.generic-page
  width: 90%
  max-width: 1600px
  margin: 0 auto
  padding-bottom: 20px
  line-height: 130%

.navigation-bar
  background-color: $filterbar-background
  box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.1)

  .contents
    display: flex
    align-items: center
    width: 90%
    max-width: 1600px
    padding: 10px 0
    margin: 0 auto
    justify-content: space-between

    button.back-bar-item
      color: $accent
      cursor: pointer
      white-space: nowrap
      padding-right: 5px

    .back-bar-item
      flex: 1

      i.link-icon
        margin-right: 5px

      &.title-text
        flex: 3
        text-align: center

    button.back-bar-item:hover
      text-decoration: underline

    h3
      margin: 0

.sr-only
  position: absolute
  left: -10000px
  top: auto
  width: 1px
  height: 1px
  overflow: hidden

.clearfix
  clear: both

.space-between
  display: flex
  justify-content: space-between

.help-text
  font-size: 90%
  font-style: italic

.error-wrapper
  display: flex
  flex-direction: column
  max-width: 300px
  text-align: center
  margin: 50px auto 0 auto
  padding: 0 20px

  span
    margin-top: 20px

.fix-at-bottom
  position: fixed
  bottom: 10px
  right: 0
  z-index: 5
  display: flex
  align-items: flex-end

.show-on-focus
  position: absolute
  width: 1px
  height: 1px
  margin: 0
  overflow: hidden
  clip: rect(1px, 1px, 1px, 1px)

.show-on-focus:focus
  z-index: 20
  width: auto
  height: auto
  clip: auto
    // If show-on-focus gets used in more places, these styling rules can
    // be broken out into different styles.
  padding: 16px !important
  background-color: $accent !important
  color: $title-color !important
  top: 0
  left: 0

.timeline.dots
  padding-bottom: 10px

  &::before
    background: linear-gradient(180deg, $timeline-line-color 25%, $main-background 25%, $main-background 50%, $timeline-line-color 50%, $timeline-line-color 75%, $main-background 75%, $main-background 100%)
    background-size: 100% 16px

.load-top
  display: flex
  justify-content: center

  button
    margin: 10px 0
    background-color: $accent
    color: $title-color
    padding: 5px 10px
    border: 0
    box-shadow: 2px 2px 1px rgba(0, 0, 0, 0.4)
    cursor: pointer

    &:active, &:hover
      box-shadow: 1px 1px 1px rgba(0, 0, 0, 0.4)

.timeline-entry.single .timeline-description:after
  display: none

.timeline-body-text-wrapper
  position: relative
  z-index: 2
  pointer-events: none

  *
    pointer-events: auto

// Glossary
.glossary-entry
  margin-top: 20px

  dt
    font-weight: bold

  &.highlighted
    background-color: $highlight-background
    padding: 5px

/* ICON COLORS */
.timeline-icon
  @each $name, $color in $icon-colors
    &.#{$name}
      background-color: $color

/* RESPONSIVENESS */
@media only screen and (min-width: #{$md-breakpoint + 1}px)
  .timeline-entry.even .timeline-description:after
    right: -8px
    border-top-width: 1px
    border-right-width: 1px

  header.page-header.timeline-page
    min-height: 300px
    align-items: start

    li
      display: inline

      &:not(:first-child):before
        color: $header-footer-body-color
        padding: 10px

        // Avoid screenreaders reading the decorative character where supported
        // https://github.com/molly/web3-is-going-great/pull/25#issuecomment-1004279568
        content: "â€¢"
        content: "â€¢" / ""

  .timeline-entry.single
    display: flex
    justify-content: center
    margin: 10px auto

    .timeline-icon
      position: static
      margin-right: 8px

    .timeline-description
      max-width: 1000px
      width: 80%

@media only screen and (max-width: #{$md-breakpoint}px) and (min-width: #{$sm-breakpoint + 1}px)
  .timeline-entry.even .timeline-description:after
    left: -8px
    border-bottom-width: 1px
    border-left-width: 1px

  header.page-header.timeline-page .header-content
    padding-bottom: 20px

@media only screen and (min-width: #{$sm-breakpoint + 1}px)
  .timeline-description:after
    top: 14px
    content: ''
    transform: rotate(45deg)
    height: 14px
    width: 14px
    position: absolute
    border-width: 0
    border-style: solid
    box-sizing: border-box

  .timeline-entry.odd .timeline-description:after
    left: -8px
    border-bottom-width: 1px
    border-left-width: 1px

  .image-right
    width: clamp(150px, 40%, 400px)
    float: right
    padding: 10px 0 5px 10px

@media only screen and (max-width: #{$md-breakpoint}px)
  header.page-header
    h1
      font-size: 1.5em

    p, ul
      font-size: 14px

    .constrain-width
      align-items: end

  header.page-header.timeline-page
    justify-content: normal

    img.logo
      max-height: 200px

  .timeline::before
    left: 0

  .timeline-icon
    left: 2px

  .timeline-entry,
  .timeline-entry.short
    margin-top: 25px

  .timeline-entry.odd .timeline-description,
  .timeline-entry.even .timeline-description
    margin-left: 50px

  .timeline-entry.single .timeline-description
    margin-left: 30px

  .timestamp-and-link-icons ul li:not(:first-child)
    font-size: 120%
    padding-left: 10px

  .timeline-description
    width: 90%

  .load-top
    justify-content: start

    button
      margin-left: 5%

  .lightbox-container
    width: 90%

@media only screen and (max-width: #{$sm-breakpoint}px)
  header.page-header
    height: auto
    padding-top: 20px

    h1
      font-size: 1.5em

    p
      font-size: 16px

    .constrain-width
      align-items: center
      flex-direction: column-reverse

    .mobile-image-and-links
      display: flex
      justify-content: space-between
      flex-wrap: wrap

      .mobile-image-wrapper
        display: flex
        flex-grow: 1
        justify-content: center

        img.logo
          margin-left: 0px
          width: 100%
          max-width: 100px

  .captioned-image
    margin: 20px auto
    text-align: center

    img
      max-height: 400px

  .timeline
    width: auto
    margin-left: 5px

  .timestamp-and-link-icons
    margin-left: 15px

  .timeline-entry.even,
  .timeline-entry.odd
    .timeline-description
      margin-left: 10px
      padding-top: 10px
      width: calc( 100vw - 20px )

      .entry-wrapper
        margin-left: 10px
        margin-right: 10px

  .timeline:after
    display: none

  .timeline-icon
    width: 30px
    height: 30px
    margin-left: -5px
    border-width: 2px

    i
      font-size: 15px

    img
      max-width: 15px
      max-height: 15px

  .load-top button
    margin-left: 4px

.flex-between
  display: flex
  justify-content: space-between

.no-wrap
  white-space: no-wrap

#noscript
  margin: 20px auto 50px auto
  max-width: 400px
  width: 80%
  text-align: center

.navigation-bar .contents
  font-size: 80%

  button.back-bar-item
    white-space: normal

@media (prefers-reduced-motion: reduce)
  html
    scroll-behavior: auto

// DARK MODE
@mixin mainDarkMode()
  main
    background-color: $dark-main-background

  header.page-header,
  header.page-header .header-content,
  footer.page-footer
    background-color: $dark-header-footer-background

    h1, h1 a, p, ul
      color: $dark-header-footer-body-color

    img.logo
      filter: brightness(80%)

  header.page-header .header-content
    a
      border-bottom: 1px dashed lighten($header-footer-background, 20%)
      color: $dark-header-footer-link-color

    h1 a
      border-bottom: none

  header.page-header.timeline-page li:not(:first-child):before
    color: $dark-header-footer-body-color

  body,
  .timeline-description,
  h2 button,
  .timeline-filter,
  .timeline-icon i,
  .attribution
    color: $dark-main-color

  a,
  .timeline-description a,
  .attribution a
    color: $dark-link-color

  .navigation-bar
    background-color: $dark-filterbar-background
    color: $dark-filter-text

    .contents button.back-bar-item
      color: $dark-link-color

  .timeline-description
    background-color: $dark-card-background
    border-color: $dark-timeline-line-color

    h2
      button .permalink-popup
        color: $dark-main-color

      a
        color: $dark-main-color

    .entry-footer
      border-color: $dark-timeline-line-color
      background-color: $dark-card-footer-background

      button
        color: $dark-link-color

      .collection-row
        border-bottom-color: $dark-timeline-line-color

  .timeline::before
    background-color: $dark-timeline-line-color

  .timeline-icon
    border-color: $dark-timeline-line-color
    color: $dark-timeline-icon-color

    img
      filter: brightness(80%)

  .timeline-icon
    @each $name, $color in $icon-colors
      &.#{$name}
        background-color: darken($color, 20%)

  .load-top button
    color: $dark-timeline-icon-color
    background-color: darken($accent, 20%)

  .timeline.dots::before
    background: linear-gradient(180deg, $dark-timeline-line-color 25%, $dark-main-background 25%, $dark-main-background 50%, $dark-timeline-line-color 50%, $dark-timeline-line-color 75%, $dark-main-background 75%, $dark-main-background 100%)

  .timeline-description:after
    background-color: $dark-card-background
    border-color: $dark-timeline-line-color

.use-dark
  background-color: $dark-main-background
  @include mainDarkMode()
  @include filtersDarkMode()
  @include fixedDarkMode()
  @include popoversDarkMode()

@media (prefers-color-scheme: dark)
  @include mainDarkMode()
  @include filtersDarkMode()
  @include fixedDarkMode()
  @include popoversDarkMode()
